## 实验环境

- 硬件环境：
  - CPU：AMD Ryzen 7 5800H
  - 内存：16GB
- 软件环境：
  - 操作系统：Linux-x86_64-5.15.167.4-microsoft-standard-WSL2
  - 编译器/语言版本：Rust 1.83.0
  - Docker 20.10.21

## 实验结果

### **实验1: 漏洞推导**

这个实验用于生成论文表IV中的156个漏洞。主要通过运行 bp-sec-sim 工具的 exp1_derivation 命令,分析:

- PHT: 28个漏洞
- BTB: 116个漏洞 (间接跳转56个,调用指令30个,返回指令30个)
- RSB: 12个漏洞

![image-20241229130612148](https://github.com/user-attachments/assets/6ded9af8-8f76-4e5e-83ad-f8e66b7cb7a5)


### **实验2: 安全分支预测器分析**

这个实验用于生成论文表VI、VII和VIII的数据,主要包含两部分:

1. RSB refilling防御机制分析(exp2_rsb_refilling):分析RSB refilling对RSB漏洞的缓解效果，输出各类型漏洞的统计数据

   ![QQ_1735448820172](https://github.com/user-attachments/assets/56f72331-445f-4d62-8385-374b046e5c1c)


2. 安全分支预测器设计分析(exp2_secure_bp):分析8种安全分支预测器设计，评估它们对不同类型漏洞的防御效果，生成漏洞防御覆盖率统计

   ![image-20241229130805721](https://github.com/user-attachments/assets/b23e6685-cb2c-4dc2-bd5e-3acdf5bbaa70)


### **实验3: 投机执行攻击防御分析**

这个实验用于生成论文表IX的数据,包含三部分:

1. 基准分支预测器分析(exp3_baseline_bp)

   ![image-20241229130937687](https://github.com/user-attachments/assets/c5dc5330-c829-4bc2-b0b4-7756b0a0e31c)


2. 安全分支预测器分析(exp3_secure_bp)

   ![image-20241229131032064](https://github.com/user-attachments/assets/ca752d9e-c967-4546-b5f8-213e5ab494dd)


3. 硬件防御机制分析(exp3_hw_defenses)

   ![image-20241229131126109](https://github.com/user-attachments/assets/d7ead0cc-4a5e-451f-901a-52fd57ab52b2)


### **实验4: TAGE分支预测器建模**

这个实验展示了论文第IV-C节的案例研究,采用两种建模方法:

1. 将4个tagged表作为整体建模:得到34个漏洞

2. 分别建模每个表:得到106个漏洞

   ![image-20241229131157372](https://github.com/user-attachments/assets/d4120135-78a7-4783-97fc-d5560a95313b)


### **结果汇总**

**按攻击类型分类的漏洞统计**

| 防护方案  |   PHT    |            |          | BTB (ind) |            |          | BTB (call) |            |          | BTB (ret) |            |          |   RSB    |            |          |   总计   |            |          |
| --------- | :------: | :--------: | :------: | :-------: | :--------: | :------: | :--------: | :--------: | :------: | :-------: | :--------: | :------: | :------: | :--------: | :------: | :------: | :--------: | :------: |
|           | 命中内部 | 未命中内部 | 命中外部 | 命中内部  | 未命中内部 | 命中外部 |  命中内部  | 未命中内部 | 命中外部 | 命中内部  | 未命中内部 | 命中外部 | 命中内部 | 未命中内部 | 命中外部 | 命中内部 | 未命中内部 | 命中外部 |
| 基准线    |    4     |     10     |    4     |     8     |     21     |    6     |     6      |     10     |    4     |     6     |     10     |    4     |    2     |     2      |    1     |    26    |     53     |    19    |
| Lock-BTB  |    4     |     10     |    4     |     4     |     12     |    3     |     3      |     6      |    2     |     3     |     6      |    2     |    2     |     2      |    1     |    16    |     36     |    12    |
| MI6       |    2     |     6      |    2     |     8     |     21     |    6     |     6      |     10     |    4     |     6     |     10     |    4     |    2     |     2      |    1     |    24    |     49     |    17    |
| BRB       |    2     |     6      |    2     |     8     |     21     |    6     |     6      |     10     |    4     |     6     |     10     |    4     |    2     |     2      |    1     |    24    |     49     |    17    |
| Two-Level |    3     |     8      |    3     |     4     |     3      |    2     |     2      |     0      |    0     |     2     |     0      |    0     |    2     |     2      |    1     |    13    |     13     |    6     |
| Noisy-XOR |    3     |     8      |    3     |     4     |     3      |    2     |     2      |     0      |    0     |     2     |     0      |    0     |    2     |     2      |    1     |    13    |     13     |    6     |
| PSC       |    0     |     0      |    0     |     8     |     21     |    6     |     6      |     10     |    4     |     6     |     10     |    4     |    2     |     2      |    1     |    22    |     43     |    15    |
| LS-BP     |    3     |     8      |    3     |     4     |     3      |    2     |     2      |     0      |    0     |     2     |     0      |    0     |    2     |     2      |    1     |    13    |     13     |    6     |
| HyBP      |    3     |     8      |    3     |     2     |     3      |    2     |     0      |     0      |    0     |     0     |     0      |    0     |    2     |     2      |    1     |    7     |     13     |    6     |

**已知攻击和新发现攻击的漏洞统计**

| 防护方案  | 已知攻击 |           |            |           |      | 新发现攻击 |           |            |           |      |
| --------- | :------: | :-------: | :--------: | :-------: | :--: | :--------: | :-------: | :--------: | :-------: | :--: |
|           |   PHT    | BTB (ind) | BTB (call) | BTB (ret) | RSB  |    PHT     | BTB (ind) | BTB (call) | BTB (ret) | RSB  |
| 基准线    |    12    |    20     |     15     |    15     |  0   |     16     |    36     |     15     |    15     |  5   |
| Lock-BTB  |    12    |     2     |     2      |     2     |  0   |     16     |    17     |     9      |     9     |  5   |
| MI6       |    2     |    20     |     15     |    15     |  0   |     8      |    36     |     15     |    15     |  5   |
| BRB       |    2     |    20     |     15     |    15     |  0   |     8      |    36     |     15     |    15     |  5   |
| Two-Level |    5     |     5     |     1      |     1     |  0   |     13     |     7     |     1      |     1     |  5   |
| Noisy-XOR |    5     |     5     |     1      |     1     |  0   |     13     |     7     |     1      |     1     |  5   |
| PSC       |    0     |    20     |     15     |    15     |  0   |     0      |    36     |     15     |    15     |  5   |
| LS-BP     |    5     |     5     |     1      |     1     |  0   |     13     |     7     |     1      |     1     |  5   |
| HyBP      |    5     |     4     |     0      |     0     |  0   |     13     |     6     |     0      |     0     |  5   |

